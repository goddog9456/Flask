{# 舊版備份 #}
{% macro table_ct1Summ0(ct1_summ) -%}
</br>
<table class = 'redTable'>
<thead><tr>
{% for i in ct1_summ.head(1)%}
	{# loop.index 號碼從1開始, 1,2,3... #}
	{% if  loop.index >= 2 %}
	<th>{{i}}</th>
	{% endif %}
{% endfor %}
<tr></thead>

{% for key,value in ct1_summ.iterrows() %}
<tr>
                        {#    %H:%M:%S   #}
	  {# <td> <input type="submit" class='in1' value ="{{value[0].strftime('%Y/%m/%d')}}" ></td>#}
	 <td> <input type="submit" class='in1' value ="{{value['MODEL_NO']}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value['LINE']}}" name = "ct1Summ" title = 'hiii' ></td>
	 
	 <td> <input type="submit" class='in1' value ="{{value['TOT']}}" name = "ookk" title = 'hiii'></td>
	 
	 <td> <input type="submit" class='in1' value ="{{value['GO']}}" name = "ct1Summ__{{value[0].strftime('%Y/%m/%d')}}__{{value[1]}}__{{value[2]}}__GO"></td>
	 {% if value['VOBL'] >= 1%}<td bgcolor="#FFC1E0">{% else %}<td>{% endif %}
	 <input type="submit" class='in1' value ="{{value['VOBL']}}" name = "ct1Summ__{{value[0].strftime('%Y/%m/%d')}}__{{value[1]}}__{{value[2]}}__V-OPEN-BL"></td>
	 
	 {% if value['OAD'] >= 1%}<td  bgcolor="#FFC1E0">{% else %}<td>	 {% endif %}
	 <input type="submit" class='in1' value ="{{value['OAD']}}" name = "ct1Summ__{{value[0].strftime('%Y/%m/%d')}}__{{value[1]}}__{{value[2]}}__OTHER ALIGN DEFECT"></td>

	 {% if value['OAPD'] >= 1%}<td bgcolor="#FFC1E0">{% else %}<td>	{% endif %}
	 <input type="submit" class='in1' value ="{{value['OAPD']}}" name = "ct1Summ__{{value[0].strftime('%Y/%m/%d')}}__{{value[1]}}__{{value[2]}}__OTHER APPEAR DEFECT"></td>
	
	 {% if value['OGD'] >= 1%}<td bgcolor="#FFC1E0"><font color="red">{% else %}<td>	{% endif %} 
	 <input type="submit" class='in1' value ="{{value['OGD']}}" name = "ct1Summ__{{value[0].strftime('%Y/%m/%d')}}__{{value[1]}}__{{value[2]}}__OTHER GLASS DEFECT"></td>
	
	{# <td> <input type="submit" class='in1' value ="{{value['OLD']}}" name = "ct1Summ"></td> #}
	 <td> <input type="submit" class='in1' value ="{{value[10]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[11]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[12]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[13]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[14]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[15]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[16]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[17]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[18]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[19]}}" name = "ct1Summ"></td>
	 <td> <input type="submit" class='in1' value ="{{value[20]}}" name = "ct1Summ"></td>
	 

		
</tr>
{% endfor  %}
</table>
{%- endmacro %}




{# 當前版本 #}
{% macro table_ct1Summ(ct1_summ) -%}
</br>


<table class = 'redTable'>
<thead><tr>
{% for i in ct1_summ.head(1)%}
	{# loop.index 號碼從1開始, 1,2,3... #}
	{% if  loop.index >= 2 %}
	<th>{{i}}</th>
	{% endif %}
{% endfor %}
<tr></thead>


{% for key,value in ct1_summ.iterrows() %}
<tr>
	{% for i in ct1_summ.head(1)%}
		{# loop.index 號碼從1開始, 1,2,3... #}
		{% if  loop.index >= 6 and value[i] > 0%}
		
			{% if value[i]|int >= 1 and loop.index >= 6 %}<td bgcolor="#FFC1E0">{% else %}<td>	{% endif %} 
			  <input type="submit" class='in_sub' value ="{{value[i]}}" name = "ct1Summ__{{value[0].strftime('%Y/%m/%d')}}__{{value[1]}}__{{value[2]}}__{{i}}"></td>
			
		
		{% elif loop.index >= 2 %}
			<td>{{value[i]}}</td>
		
		
		
		{% endif %}
	{% endfor %}
</tr>
{% endfor %}
</table>
{%- endmacro %}



{% macro table_ct1YieldSumm(ct1_summ, original_col, drop_col) -%}
<script>

function onlyone(this){
	this.disabled=true;
}
</script>


<table class='t2'>
<thead><tr><th colspan="6"><h3>請選擇defect:</h3></th></tr>
<tr>
{% for i in original_col%}
	{# loop.index 號碼從1開始, 1,2,3... #}
	{% if  loop.index >= 5   %}
		<td><input type="checkbox"  name="chk_{{i}}" value="Y" {% if i not in drop_col %} checked{%endif%}><b class='txt2'> {{i}}</b>
		</td>
	{% endif %}
	{% if  loop.index in [9, 14, 19, 24]   %}
		</tr><tr>
	{% endif %}


{% endfor %}

</tr><table>

</br>
<table class = 'redTable'>
<thead><tr>
{% for i in ct1_summ.head(1)%}
	{# loop.index 號碼從1開始, 1,2,3... #}
	{% if  loop.index >= 2 %}
	<th>{{i}}</th>
	{% endif %}
{% endfor %}
<tr></thead>

{% for key,value in ct1_summ.iterrows() %}
<tr>
	{% for i in ct1_summ.head(1)%}
		{# loop.index 號碼從1開始, 1,2,3... #}
		{% if  loop.index >= 6 and i not in ['已Check','Check總數', 'Real_Ratio'] and  value[i] > 0%}
			{% if value[i]|int >= 1 and loop.index >= 6%}<td bgcolor="#FFC1E0">{% else %}<td>	{% endif %} 
			<input type="submit" class='in_sub' value ="{{value[i]}}" name = "ct1Summ__{{value[0].strftime('%Y/%m/%d')}}__{{value[1]}}__{{value[2]}}__{{i}}"></td>
		{% elif  i in ['已Check','Check總數'] %}
			<td>{{(value[i]|round(2)|string)[:-2]}}</td>
		{% elif  loop.index >= 2%}
			<td>{{value[i]}}</td>
		{% endif %}
	{% endfor %}
</tr>
{% endfor %}
</table>

{%- endmacro %}






{#--------------------------------------CT1共缺第二層  CHIPID檢查列表----------------------------------------------#}
{% macro table_ct1Summ_chipid(ct1_summ_chipid, imgLinks, l7ah1_imgs) -%}
</br>
<table class = 'redTable'>
<thead><tr>
{% for i in ct1_summ_chipid.head(1)%}
	{# loop.index 號碼從1開始, 1,2,3... #}
	{% if loop.index <= 8 %}
	<th>{{i}}</th>
	{% endif %}
{% endfor %}

<th>img01</th>
<th>img02</th>
<th>img03</th>
<th>img_l7ah1</th>
<tr></thead>

<script language="JavaScript" type="text/javascript">
   function PopupPic(sPicURL) { 
	 window.open( "static/popup_ct1.htm?"+sPicURL,"","resizable=1"); 
   } 
</script>
{% for key,value in ct1_summ_chipid.iterrows() %}
{% set idx = 0 %}<tr>
                        {#    %H:%M:%S   #}
	 <td> <input type="text" class='in1' name='CHIPID__{{key}}' value ="{{value['CHIPID']}}" size="6" readonly></td>
	 <td> <input type="text" class='in1' name='MODEL_NO__{{key}}' value ="{{value['MODEL_NO']}}" size="9" readonly></td>
	 <td> <input type="text" class='in1' name='TEST_TIME__{{key}}' value ="{{value['TEST_TIME']}}" size="15" readonly></td>
	 <td> <input type="text" class='in1' name='TEST_USER__{{key}}' value ="{{value['TEST_USER']}}" size="9" readonly></td>
	 <td> <input type="text" class='in1' name='DEFECT_CODE_DESC__{{key}}' value ="{{value['DEFECT_CODE_DESC']}}" size="24" readonly></td>
	 <td> <input type="text" class='in1' name='X__{{key}}' value ="{{value['X']}}" size="3" readonly></td>
	 <td> <input type="text" class='in1' name='Y__{{key}}' value ="{{value['Y']}}" size="3" readonly></td>
	 <td> <input type="text" class='in1' name='PATTERN_CODE__{{key}}' value ="{{value['PATTERN_CODE']}}" size="4" readonly></td>
	 
	 
	 {% if imgLinks[key]|length <= 3 %}
		{% for imgs in imgLinks[key] %}
		<td>
		 
			
			{% if imgs[-4:] == '.tif' %}
			<a href="{{ imgs }}" onerror="this.src='https://png.pngtree.com/element_our/20190528/ourmid/pngtree-fork-symbol-icon-design-image_1164181.jpg'" >CCD{{loop.index}}</a>
			{% set idx = idx+1 %}
			{% elif imgs == ' ' %}
			No Img
			{% elif value['PATTERN_CODE'] == 'MHGO3'%}
				<a href="{{ imgs }}"><img align="center" width='160' height='120' src="{{ imgs }}" onerror="javascript:this.src='{{imgs[:-15]+'3'+imgs[-15:]}}';"></a>  

			{% else  %} 
         {#javascript:PopupPic('{{ imgs }}')#}                                                                 {# onerror="this.parentNode.removeChild(this)" #}
		<a href="{{ imgs }}"><img align="center" width='160' height='120' src="{{ imgs }}" onerror="this.src='https://png.pngtree.com/element_our/20190528/ourmid/pngtree-fork-symbol-icon-design-image_1164181.jpg'"></a>  
			{% endif  %}
			<input type="text" value ="{{ imgs }}" name = "IMG{{loop.index}}__{{key}}" style="width:0; height:0; border:0; text-indent:-9999px;"></td>
			
		</td>
		{% endfor %}
		
		
	{%else %}
		<td colspan=3>影像張數較多，另於下方表格顯示。</td>
	{% endif  %}
	
	
	
	{% for imgs in l7ah1_imgs[key] %}
	<td>
	 
		
		{% if imgs[-4:] == '.jpg' %}
		<a href="{{ imgs }}" onerror="this.src='https://png.pngtree.com/element_our/20190528/ourmid/pngtree-fork-symbol-icon-design-image_1164181.jpg'" download= >Image Link</a>
		{% set idx = idx+1 %}
		{% elif imgs|length == 0 %}
		Not find
		
		{% else  %} 
	 {#javascript:PopupPic('{{ imgs }}')#}                                                                 {# onerror="this.parentNode.removeChild(this)" #}
	<a href="{{ imgs }}"><img align="center" width='50' height='200' src="{{ imgs }}" onerror="this.src='https://png.pngtree.com/element_our/20190528/ourmid/pngtree-fork-symbol-icon-design-image_1164181.jpg'"></a>  
		{% endif  %}
		
	</td>
	{% endfor %}
	
		
	
	
	
	
		
</tr>
{% endfor  %}
</table>
</br></br>
{# 圖太多張時，移至下方另以表格呈現 #}
<table class = 'redTable'>

<thead><tr>


<th>CHIPID</th>
<th>01</th>
<th>02</th>
<th>03</th>
<tr></thead>



{% for key,value in ct1_summ_chipid.iterrows() %}
{% set idx = 0 %}
<tr>
     {% if imgLinks[key]|length > 3 %}
		                    
		<td> <input type="text" class='in1' value ="{{value[0]}}" readonly></td>
		{% for imgs in imgLinks[key] %}
		{% if loop.index in [4, 7,10,13,16,19,22,25,28] %}
		</tr><tr><td></td>
			{% endif  %}
		<td>
		
			
		
		
			{% if imgs[-4:] == '.tif' %}
			<a href="{{ imgs }}">CCD{{loop.index}}</a>
			{% set idx = idx+1 %}
			{% elif imgs == ' ' %}
			
			{% else  %}
			<a href="{{ imgs }}"><img align="center" width='160' height='120' src="{{ imgs }}" onerror="this.src='http://pic.616pic.com/ys_bnew_img/00/29/77/kYTse4RjqB.jpg'"></a>
			{% endif  %}
			<input type="text" value ="{{ imgs }}" name = "IMG{{loop.index}}__{{key}}" style="width:0; height:0; border:0; text-indent:-9999px;"></td>
			
		</td>
		{% endfor %}
		
		
		
	
		
	{% endif  %}
		
</tr>
{% endfor  %}
</table>

</br></br>
{%- endmacro %}










